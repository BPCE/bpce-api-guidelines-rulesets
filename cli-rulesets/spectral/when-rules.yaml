rules:
  a-delete-must-return-a-204-without-when:
    summary: Only 204 allowed on delete (without when)
    given: $.paths[*].delete.responses
    severity: 0
    # Working at the key (HTTP status) level inside each reponses object
    then:
      field: "@key"
      function: pattern
      functionOptions:
        match: ^(204)$
  a-delete-must-return-a-204-with-when:
    summary: Only 204 allowed on delete (without when)
    given: $.paths[*].delete.responses
    severity: 0
    when:
      field: "@key"
      pattern: ^(2\d\d)$
    then:
      field: "@key"
      function: pattern
      functionOptions:
        match: ^(204)$
  a-delete-success-description-must-contani-deleted:
    summary: Only 204 allowed on delete (without when)
    given: $.paths[*].delete.responses
    severity: 0
    when:
      field: "@key"
      pattern: ^(2\d\d)$
    then:
      field: "description"
      function: pattern
      functionOptions:
        match: ^.*deleted.*$